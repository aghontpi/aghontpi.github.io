<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="815px" preserveAspectRatio="none" style="width:886px;height:815px;background:#FFFFFF;" version="1.1" viewBox="0 0 886 815" width="886px" zoomAndPan="magnify"><defs/><g><g><title>Controller</title><rect fill="#FFFFFF" height="686.3359" style="stroke:#181818;stroke-width:1;" width="10" x="281.4604" y="112.4297"/></g><g><title>RateLimiter</title><rect fill="#FFFFFF" height="404.3359" style="stroke:#181818;stroke-width:1;" width="10" x="566.6074" y="191.8281"/></g><g><title>Firestore</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="718.168" y="220.9609"/></g><rect fill="none" height="324.0703" style="stroke:#000000;stroke-width:1.5;" width="654.5996" x="224.874" y="265.0938"/><rect fill="none" height="204.7344" style="stroke:#000000;stroke-width:1.5;" width="634.5996" x="234.874" y="377.4297"/><rect fill="none" height="188.6016" style="stroke:#000000;stroke-width:1.5;" width="503.5371" x="10" y="603.1641"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="727.4688" width="8" x="34.9551" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="38" x2="38" y1="81.2969" y2="808.7656"/></g><g><title>Controller</title><rect fill="#000000" fill-opacity="0.00000" height="727.4688" width="8" x="282.4604" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="285.874" x2="285.874" y1="81.2969" y2="808.7656"/></g><g><title>RateLimiter</title><rect fill="#000000" fill-opacity="0.00000" height="727.4688" width="8" x="567.6074" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="570.8652" x2="570.8652" y1="81.2969" y2="808.7656"/></g><g><title>Firestore</title><rect fill="#000000" fill-opacity="0.00000" height="727.4688" width="8" x="719.168" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="723.1533" x2="723.1533" y1="81.2969" y2="808.7656"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="20" y="77.9951">User</text><ellipse cx="38.9551" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.9551,21.5 L38.9551,48.5 M25.9551,29.5 L51.9551,29.5 M38.9551,48.5 L25.9551,63.5 M38.9551,48.5 L51.9551,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Ctrl"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83.1729" x="244.874" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.1729" x="251.874" y="69.9951">Controller</text></g><g class="participant participant-head" data-participant="RL"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95.4844" x="523.8652" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.4844" x="530.8652" y="69.9951">RateLimiter</text></g><g class="participant participant-head" data-participant="DB"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62.0293" x="689.1533" y="77.9951">Firestore</text><path d="M705.168,29 C705.168,19 723.168,19 723.168,19 C723.168,19 741.168,19 741.168,29 L741.168,55 C741.168,65 723.168,65 723.168,65 C723.168,65 705.168,65 705.168,55 L705.168,29" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M705.168,29 C705.168,39 723.168,39 723.168,39 C723.168,39 741.168,39 741.168,29" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g><title>Controller</title><rect fill="#FFFFFF" height="686.3359" style="stroke:#181818;stroke-width:1;" width="10" x="281.4604" y="112.4297"/></g><g><title>RateLimiter</title><rect fill="#FFFFFF" height="404.3359" style="stroke:#181818;stroke-width:1;" width="10" x="566.6074" y="191.8281"/></g><g><title>Firestore</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="718.168" y="220.9609"/></g><g class="message" data-participant-1="User" data-participant-2="Ctrl"><polygon fill="#181818" points="269.4604,108.4297,279.4604,112.4297,269.4604,116.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="38.9551" x2="275.4604" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.3901" x="133.5127" y="107.3638">Request</text></g><path d="M296,125.4297 L296,165.4297 L412,165.4297 L412,135.4297 L402,125.4297 L296,125.4297" fill="#FFFFA5" style="stroke:#181818;stroke-width:0.5;"/><path d="M402,125.4297 L402,135.4297 L412,135.4297 L402,125.4297" fill="#FFFFA5" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.9014" x="302" y="142.4966">1. Extract IP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.6274" x="302" y="157.6294">2. Read Config</text><g class="message" data-participant-1="Ctrl" data-participant-2="RL"><polygon fill="#181818" points="554.6074,187.8281,564.6074,191.8281,554.6074,195.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="291.4604" x2="560.6074" y1="191.8281" y2="191.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.147" x="300.9604" y="186.7622">Check Rate Limit (ip, window, maxHits)</text></g><g class="message" data-participant-1="RL" data-participant-2="DB"><polygon fill="#181818" points="706.168,216.9609,716.168,220.9609,706.168,224.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="576.6074" x2="712.168" y1="220.9609" y2="220.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.481" x="605.1472" y="215.895">Get Data (ip)</text></g><g class="message" data-participant-1="DB" data-participant-2="RL"><polygon fill="#181818" points="587.6074,246.0938,577.6074,250.0938,587.6074,254.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="581.6074" x2="722.168" y1="250.0938" y2="250.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.5127" x="607.6313" y="245.0278">Current Data</text></g><path d="M224.874,265.0938 L289.3169,265.0938 L289.3169,272.2266 L279.3169,282.2266 L224.874,282.2266 L224.874,265.0938" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="324.0703" style="stroke:#000000;stroke-width:1.5;" width="654.5996" x="224.874" y="265.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="239.874" y="278.1606">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="176.7788" x="304.3169" y="277.3042">[First Visit OR Time Expired]</text><g class="message" data-participant-1="RL" data-participant-2="DB"><polygon fill="#181818" points="711.168,314.4922,721.168,318.4922,711.168,322.4922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="576.6074" x2="717.168" y1="318.4922" y2="318.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.5605" x="588.6074" y="298.2935">Reset Count to 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.7505" x="594.0125" y="313.4263">(Start new timer)</text></g><g class="message" data-participant-1="RL" data-participant-2="Ctrl"><polygon fill="#181818" points="302.4604,343.625,292.4604,347.625,302.4604,351.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="296.4604" x2="565.6074" y1="347.625" y2="347.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43.9512" x="353.2207" y="342.5591">Return</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38.3145" x="401.3042" y="342.5591">TRUE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.0962" x="443.751" y="342.5591">(Allowed)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="224.874" x2="879.4736" y1="356.625" y2="356.625"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="150.0791" x="229.874" y="366.8354">[Time Window is Active]</text><path d="M234.874,377.4297 L299.3169,377.4297 L299.3169,384.5625 L289.3169,394.5625 L234.874,394.5625 L234.874,377.4297" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="204.7344" style="stroke:#000000;stroke-width:1.5;" width="634.5996" x="234.874" y="377.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="249.874" y="390.4966">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="155.2031" x="314.3169" y="389.6401">[Count &lt; MaxHits (Safe)]</text><path d="M581,399.5625 L581,424.5625 L859,424.5625 L859,409.5625 L849,399.5625 L581,399.5625" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M849,399.5625 L849,409.5625 L859,409.5625 L849,399.5625" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="257.4736" x="587" y="416.6294">Crucial Step: Increment Count (+1)</text><g class="message" data-participant-1="RL" data-participant-2="DB"><polygon fill="#181818" points="711.168,461.9609,721.168,465.9609,711.168,469.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="576.6074" x2="717.168" y1="465.9609" y2="465.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="108.6782" x="595.5486" y="445.7622">Update Record</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.8286" x="591.4734" y="460.895">(Add +1 to count)</text></g><g class="message" data-participant-1="RL" data-participant-2="Ctrl"><polygon fill="#181818" points="302.4604,491.0938,292.4604,495.0938,302.4604,499.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="296.4604" x2="565.6074" y1="495.0938" y2="495.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43.9512" x="353.2207" y="490.0278">Return</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38.3145" x="401.3042" y="490.0278">TRUE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.0962" x="443.751" y="490.0278">(Allowed)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="234.874" x2="869.4736" y1="504.0938" y2="504.0938"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="224.9683" x="239.874" y="514.3042">[Count &gt;= MaxHits (Limit Reached)]</text><path d="M581,522.8984 L581,547.8984 L719,547.8984 L719,532.8984 L709,522.8984 L581,522.8984" fill="#FFC0CB" style="stroke:#181818;stroke-width:0.5;"/><path d="M709,522.8984 L709,532.8984 L719,532.8984 L709,522.8984" fill="#FFC0CB" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="117.4443" x="587" y="539.9653">Limit Exceeded!</text><g class="message" data-participant-1="RL" data-participant-2="Ctrl"><polygon fill="#181818" points="302.4604,570.1641,292.4604,574.1641,302.4604,578.1641" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="296.4604" x2="565.6074" y1="574.1641" y2="574.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43.9512" x="349.4153" y="569.0981">Return</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="45.4683" x="397.4988" y="569.0981">FALSE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.5532" x="447.0994" y="569.0981">(Blocked)</text></g><path d="M10,603.1641 L74.4429,603.1641 L74.4429,610.2969 L64.4429,620.2969 L10,620.2969 L10,603.1641" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="188.6016" style="stroke:#000000;stroke-width:1.5;" width="503.5371" x="10" y="603.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="616.231">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="199.6221" x="89.4429" y="615.3745">[Rate Limit Exceeded (Blocked)]</text><path d="M296,625.2969 L296,650.2969 L435,650.2969 L435,635.2969 L425,625.2969 L296,625.2969" fill="#FFC0CB" style="stroke:#181818;stroke-width:0.5;"/><path d="M425,625.2969 L425,635.2969 L435,635.2969 L425,625.2969" fill="#FFC0CB" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="118.2251" x="302" y="642.3638">Stop Processing</text><g class="message" data-participant-1="Ctrl" data-participant-2="User"><polygon fill="#181818" points="49.9551,687.6953,39.9551,691.6953,49.9551,695.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.9551" x2="280.4604" y1="691.6953" y2="691.6953"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="174.7764" x="72.8196" y="671.4966">429 Too Many Requests</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.5054" x="50.9551" y="686.6294">{"error": "Too many requests..."}</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="513.5371" y1="700.6953" y2="700.6953"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="184.5024" x="15" y="710.9058">[Rate Limit Passed (Allowed)]</text><path d="M296,719.5 L296,744.5 L376,744.5 L376,729.5 L366,719.5 L296,719.5" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M366,719.5 L366,729.5 L376,729.5 L366,719.5" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59.5156" x="302" y="736.5669">Proceed</text><g class="message" data-participant-1="Ctrl" data-participant-2="Ctrl"><line style="stroke:#181818;stroke-width:1;" x1="291.4604" x2="333.4604" y1="770.7656" y2="770.7656"/><line style="stroke:#181818;stroke-width:1;" x1="333.4604" x2="333.4604" y1="770.7656" y2="783.7656"/><line style="stroke:#181818;stroke-width:1;" x1="292.4604" x2="333.4604" y1="783.7656" y2="783.7656"/><polygon fill="#181818" points="302.4604,779.7656,292.4604,783.7656,302.4604,787.7656" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="193.0767" x="298.4604" y="765.6997">Allowed to process logic...</text></g><!--SRC=[ZLHBKzim4BxhLspD9J6GJfZsq0na9WzecGbJne7smaMLDaOJHt8bfO7fzBztLqw80ptK1uzbVxlVGok7fR6rz7858JvNI7TlL5olAX7sN_3d6gt26mn1bZYgJ6b1eOteMoZh8ewbMfRUhQsUkCfvEBgYQ_HH2AaYBRFxW3u36O0V1DL5eqmjROHiucpqhggsW4dqrI6Wa15dPcNY5b7CX9PH_f018Rio7WDHOFeq7Gl1370wJ8q6KB2545c7-KMDclw2DOCtvMC4jsZU0VHxSFaKFK7X-fRMPpqgbnf8uSAK0grENeLWF5CKim5C7b4jWJL24WaTKv_0nbZjDYUmaazVJ0pTFJ-f5yMCgwVZ0Np625ComrKj4FcOZk5qHx7sda9FGA6nZHAoYa0PX0ZVJ23shmNScHMIaPgIqUG2O4-NvmK6efpGJaM83lfv_c0xyqXvWyKDHAhrtPUgLennxItLtnNtbtaEdL5LkGtghX1OqJuapk_9D9W08vQ8gKswiSg6ynnkcaYWCvSBRAZuEjmH8Z-gU55wHCl29twjZAnW7h4UmBLL7bSSIjEsSzplvlbBixRZ-rgdt54vhvFTaTPmt6VxYekx1sN_ONa7Jm_9VYDYUB4trym2ZOzwR9UyTLaRksIPJS7baqBKgD-zClDMrTLeDa-onfLJonq7pMYJEZ-qHeMdZZUXDQSxgbSTtfwClSPvT3NSUgVeVs1ikTMuEmryy0Pmlg3pJC7IN-221d2Ovn_EFi6TSvIDVTwTnv3dv-yPENomlpFqtlbi01d3LWppMrYlryl-R1rnq2tzjp84Ld-mBVzIVpX7IJxgLzgRSFDysundesvyGkLAeqW7LN2exLIvwYy0]--></g></svg>